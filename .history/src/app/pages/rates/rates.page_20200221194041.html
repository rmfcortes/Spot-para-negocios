<ion-header>
    <ion-toolbar color="primary">
        <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>Reseñas</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content>
    <ng-container *ngIf="rateNegReady && rateRepReady; else loadTemplate">
        <ng-container *ngIf="rate && perfilNegocio; else rateTemplate">
            <ion-card>
                <ion-item detail (click)="verCalificaciones(perfilNegocio.idNegocio, 'negocio', rate.calificaciones, perfilNegocio.nombre)">
                    <ion-avatar style="margin-right: 0.5rem;">
                        <img [src]="perfilNegocio.foto" />
                    </ion-avatar>
                    <ion-label>
                        <h2>{{perfilNegocio.nombre}}</h2>
                        <app-stars *ngIf="rate.promedio" [calificacion]="rate.promedio"></app-stars>
                        <p>{{rate.calificaciones}} calificaciones</p>
                    </ion-label>
                </ion-item>
            </ion-card>
            <ion-card *ngIf="repartidores.length > 0">
                <ion-list>
                    <ion-list-header>
                        <ion-label color="primary">Repartidores</ion-label>
                    </ion-list-header>
                    <ion-item *ngFor="let item of repartidores" detail (click)="verCalificaciones(item.id, 'repartidor', item.calificaciones, item.nombre)">
                        <ion-avatar style="margin-right: 0.5rem;">
                            <img [src]="item.foto" />
                        </ion-avatar>
                        <ion-label>
                            <h2>{{item.nombre}}</h2>
                            <app-stars *ngIf="item.promedio" [calificacion]="item.promedio"></app-stars>
                            <p *ngIf="item.calificaciones > 1">{{item.calificaciones}} calificaciones</p>
                        </ion-label>
                    </ion-item>
                </ion-list>
            </ion-card>
        </ng-container>
        <ng-template #rateTemplate>
            <ion-item lines="none" style="text-align: center;">
                <ion-label class="ion-text-wrap" color="medium">Completa la información de tu perfil para poder recibir comentarios y reseñas de tus clientes</ion-label>
            </ion-item>
        </ng-template>
    </ng-container>
    <ng-template #loadTemplate>
        <ion-card>
            <ion-item>
                <ion-avatar style="margin-right: 0.5rem;">
                    <ion-skeleton-text animated></ion-skeleton-text>
                </ion-avatar>
                <ion-label>
                    <h2>
                        <ion-skeleton-text animated style="width: 50%;"></ion-skeleton-text>
                    </h2>
                    <p>
                        <ion-skeleton-text animated style="width: 90%;"></ion-skeleton-text>
                    </p>
                    <p>
                        <ion-skeleton-text animated style="width: 65%;"></ion-skeleton-text>
                    </p>
                </ion-label>
            </ion-item>
        </ion-card>
        <ion-card>
            <ion-list>
                <ion-item *ngFor="let item of [1,2,3,4,5,6]">
                    <ion-avatar style="margin-right: 0.5rem;">
                        <ion-skeleton-text animated></ion-skeleton-text>
                    </ion-avatar>
                    <ion-label>
                        <h2>
                            <ion-skeleton-text animated style="width: 50%;"></ion-skeleton-text>
                        </h2>
                        <p>
                            <ion-skeleton-text animated style="width: 90%;"></ion-skeleton-text>
                        </p>
                        <p>
                            <ion-skeleton-text animated style="width: 65%;"></ion-skeleton-text>
                        </p>
                    </ion-label>
                </ion-item>
            </ion-list>
        </ion-card>
    </ng-template>

</ion-content>